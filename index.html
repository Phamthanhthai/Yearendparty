<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>T·∫•t ni√™n Gia ƒê√¨nh Nh√† T√°o</title>

<style>
:root{--gold:#ffd666;--text:#fff}
*{box-sizing:border-box}
html,body{
  margin:0;height:100%;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:var(--text);
  background:
    radial-gradient(1000px 600px at 10% -10%, rgba(255,214,102,.25), transparent 60%),
    radial-gradient(1000px 600px at 90% -10%, rgba(179,0,0,.35), transparent 60%),
    linear-gradient(180deg,#000,#120000);
}
.center{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:16px}
.panel{
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.15);
  padding:22px;border-radius:18px;
  max-width:420px;width:100%;text-align:center;
  box-shadow:0 30px 70px rgba(0,0,0,.6);
}
input{
  width:100%;padding:12px;border-radius:12px;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.25);color:#fff;margin-top:10px;
}
.btn{
  margin-top:12px;width:100%;padding:12px;border-radius:14px;
  border:none;font-weight:800;cursor:pointer;
  background:linear-gradient(90deg,var(--gold),#fff2a8);color:#4b2c00;
}
.btn.secondary{
  background:rgba(0,0,0,.35);color:#fff;border:1px solid rgba(255,255,255,.2);
}
.hidden{display:none}

/* POPUP */
.popup{
  position:fixed;inset:0;background:rgba(0,0,0,.65);
  display:flex;align-items:center;justify-content:center;z-index:9999;
}
.popup-box{
  background:rgba(30,0,0,.95);
  border:1px solid rgba(255,255,255,.2);
  border-radius:18px;padding:22px;max-width:320px;text-align:center;
}

/* INVITE */
.wrap{max-width:760px;margin:auto;padding:16px}
.invite{
  display:none;
  background:rgba(255,255,255,.08);
  border-radius:20px;padding:18px;
}
.badge{
  display:inline-block;padding:8px 16px;border-radius:999px;
  background:linear-gradient(90deg,var(--gold),#fff2a8);
  color:#4b2c00;font-weight:900;
}
.countdown{
  display:flex;gap:10px;justify-content:center;margin:14px 0;flex-wrap:wrap;
}
.timebox{
  background:rgba(0,0,0,.3);padding:10px 14px;border-radius:14px;
}
.timebox .num{font-size:26px;font-weight:900}

/* SAD */
.sad{
  margin-top:20px;
  background:rgba(0,0,0,.45);
  border:1px dashed rgba(255,255,255,.25);
  padding:20px;border-radius:18px;
}
canvas{position:fixed;inset:0;pointer-events:none}
</style>
</head>

<body>

<canvas id="fx"></canvas>

<!-- STEP 1 -->
<div class="center" id="step1">
  <div class="panel">
    <h2>üéâ Nh·∫≠p t√™n c·ªßa b·∫°n</h2>
    <p>Ch·ªâ d√†nh cho: <b>Nga</b> ‚Ä¢ <b>Ho√†</b> ‚Ä¢ <b>Trang</b> ‚Ä¢ <b>Th√°i</b></p>
    <input id="guestName" placeholder="V√≠ d·ª•: Th√°i"/>
    <button class="btn" id="btnNext">Ti·∫øp t·ª•c</button>
  </div>
</div>

<!-- STEP 2 -->
<div class="center hidden" id="step2">
  <div class="panel">
    <h2 id="ask"></h2>
    <button class="btn" id="yes">C√≥, m√¨nh tham gia üéä</button>
    <button class="btn secondary" id="no">Kh√¥ng tham gia üò¢</button>
  </div>
</div>

<!-- INVITE -->
<div class="wrap">
  <div class="invite" id="invite">
    <div style="text-align:center">
      <div class="badge">T·∫§T NI√äN GIA ƒê√åNH NH√Ä T√ÅO</div>
      <h2 id="guest"></h2>

      <div class="countdown">
        <div class="timebox"><div class="num" id="d">--</div>Ng√†y</div>
        <div class="timebox"><div class="num" id="h">--</div>Gi·ªù</div>
        <div class="timebox"><div class="num" id="m">--</div>Ph√∫t</div>
        <div class="timebox"><div class="num" id="s">--</div>Gi√¢y</div>
      </div>

      <p>‚è≥ <b>19h30 ‚Äì 14/02 (27 √Çm)</b></p>
      <div id="status"></div>
    </div>
  </div>
</div>

<!-- POPUP -->
<div id="popup" class="popup hidden">
  <div class="popup-box">
    <h3>‚ùå Kh√¥ng h·ª£p l·ªá</h3>
    <p>T√™n n√†y kh√¥ng n·∫±m trong gia ƒë√¨nh ch√∫ng t√¥i</p>
    <button class="btn" id="closePopup">ƒê√£ hi·ªÉu</button>
  </div>
</div>

<script>
/* ===== FIREWORKS ===== */
const c=document.getElementById("fx"),x=c.getContext("2d");
let W,H;function rs(){W=c.width=innerWidth;H=c.height=innerHeight}
rs();addEventListener("resize",rs);
let p=[];
function boom(x0,y0){
  for(let i=0;i<60;i++)
    p.push({x:x0,y:y0,a:Math.random()*Math.PI*2,s:Math.random()*5+2});
}
(function draw(){
  x.clearRect(0,0,W,H);
  p.forEach(o=>{
    o.x+=Math.cos(o.a)*o.s;
    o.y+=Math.sin(o.a)*o.s;
    o.s*=0.95;
    x.fillStyle="gold";
    x.fillRect(o.x,o.y,3,3);
  });
  p=p.filter(o=>o.s>0.6);
  requestAnimationFrame(draw);
})();

/* ===== UTIL ===== */
function norm(s){
  return s.toLowerCase().normalize("NFD")
    .replace(/[\u0300-\u036f]/g,"")
    .replace(/ƒë/g,"d").trim();
}
const allow=["nga","hoa","trang","thai"];

/* ===== POPUP ===== */
const popup=document.getElementById("popup");
document.getElementById("closePopup").onclick = (e) => {
  e.stopPropagation();       // ‚õî ch·∫∑n bubbling
  popup.classList.add("hidden");
};

popup.onclick = (e) => {
  if (e.target === popup) {
    popup.classList.add("hidden");
  }
};

/* ===== FLOW ===== */
const step1=document.getElementById("step1");
const step2=document.getElementById("step2");
const invite=document.getElementById("invite");
const guest=document.getElementById("guest");
const ask=document.getElementById("ask");
const status=document.getElementById("status");
const guestName=document.getElementById("guestName");

btnNext.onclick=()=>{
  const raw=guestName.value.trim();
  if(raw==="") return;                // ‚õî ch∆∞a nh·∫≠p th√¨ kh√¥ng l√†m g√¨
  if(!allow.includes(norm(raw))){
    popup.classList.remove("hidden");
    return;
  }
  step1.classList.add("hidden");
  step2.classList.remove("hidden");
  ask.innerText=`${raw} ∆°i, t·ªëi nay ƒëi t·∫•t ni√™n c√πng gia ƒë√¨nh nh√©?`;
};

yes.onclick=()=>finish(true);
no.onclick=()=>finish(false);

function finish(ok){
  step2.classList.add("hidden");
  invite.style.display="block";
  guest.innerText=`${guestName.value} th√¢n m·∫øn`;

  if(ok){
    status.innerHTML="üéâ R·∫•t vui v√¨ c√≥ b·∫°n tham gia!";
    boom(0,0);boom(W,0);boom(0,H);boom(W,H);
  }else{
    status.innerHTML=`
      <div class="sad">
        <h3>ü•Ä B√†n ti·ªác h√¥m nay th·∫≠t bu·ªìn‚Ä¶</h3>
        <p>V√¨ thi·∫øu v·∫Øng b·∫°n, b·ªØa ti·ªác kh√¥ng c√≤n tr·ªçn v·∫πn üòî</p>
      </div>`;
  }
}

/* ===== COUNTDOWN 14/02 19:30 ===== */
const target=new Date(new Date().getFullYear(),1,14,19,30);
if(new Date()>target)target.setFullYear(target.getFullYear()+1);

setInterval(()=>{
  let diff=target-new Date();
  const s=Math.max(0,Math.floor(diff/1000));
  d.innerText=Math.floor(s/86400);
  h.innerText=Math.floor(s%86400/3600);
  m.innerText=Math.floor(s%3600/60);
  document.getElementById("s").innerText=s%60;
},1000);
</script>

</body>
</html>
